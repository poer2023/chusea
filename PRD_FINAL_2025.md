# AI Writing Tool - å®Œæ•´äº§å“éœ€æ±‚æ–‡æ¡£ v2.0
> åŸºäº2025å¹´7æœˆæœ€æ–°æŠ€æœ¯æ ˆçš„æ™ºèƒ½å†™ä½œå·¥å…·å®Œæ•´PRD

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-07-13  
**æŠ€æœ¯æ¶æ„ç‰ˆæœ¬**: 2025Q3  

---

## ğŸ“– ç›®å½•
1. [äº§å“æ„¿æ™¯](#1-äº§å“æ„¿æ™¯)
2. [ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯](#2-ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯)
3. [å¸‚åœºåˆ†æä¸ç«å“](#3-å¸‚åœºåˆ†æä¸ç«å“)
4. [æ ¸å¿ƒåŠŸèƒ½è§„åˆ’](#4-æ ¸å¿ƒåŠŸèƒ½è§„åˆ’)
5. [å¾ªç¯å¼•æ“è®¾è®¡](#5-å¾ªç¯å¼•æ“è®¾è®¡)
6. [ç”¨æˆ·ç•Œé¢è§„èŒƒ](#6-ç”¨æˆ·ç•Œé¢è§„èŒƒ)
7. [æŠ€æœ¯æ¶æ„ï¼ˆ2025ç‰ˆï¼‰](#7-æŠ€æœ¯æ¶æ„2025ç‰ˆ)
8. [21st.devç»„ä»¶é›†æˆ](#8-21stdevç»„ä»¶é›†æˆ)
9. [å®ç°è·¯çº¿å›¾](#9-å®ç°è·¯çº¿å›¾)
10. [é£é™©è¯„ä¼°ä¸ç¼“è§£](#10-é£é™©è¯„ä¼°ä¸ç¼“è§£)
11. [æˆåŠŸæŒ‡æ ‡](#11-æˆåŠŸæŒ‡æ ‡)

---

## 1. äº§å“æ„¿æ™¯

### 1.1 æ ¸å¿ƒä»·å€¼ä¸»å¼ 
**æ‰“é€ ä¸€æ¬¾ã€Œä¸€æ¡æŒ‡ä»¤å³å¯æŒç»­ç”Ÿæˆä¸è‡ªæˆ‘å®¡æ ¡ã€çš„ AI å†™ä½œå·¥å…·**

- **æœ€å°‘æ‰‹åŠ¨æ“ä½œ**: ä¸€æ¬¡æ€§å¯åŠ¨åè‡ªåŠ¨å®Œæˆå†™ä½œå…¨æµç¨‹
- **è´¨é‡ä¿éšœ**: å¾ªç¯è‡ªæ£€ç›´åˆ°è¾¾åˆ°å¯è¯»æ€§â‰¥70çš„æ ‡å‡†
- **é€æ˜å¯æ§**: å®Œæ•´ç‰ˆæœ¬æ ‘ï¼Œæ¯ä¸€æ­¥å¯è§†åŒ–å’Œå¯å›æ»š
- **ä¸“ä¸šå¼•ç”¨**: å®æ—¶æ ¡éªŒå¼•ç”¨çœŸä¼ªï¼Œæ”¯æŒå¤šç§å­¦æœ¯æ ¼å¼
- **å¤šåœºæ™¯é€‚é…**: å­¦æœ¯è®ºæ–‡ã€åšå®¢åˆ›ä½œã€ç¤¾äº¤åª’ä½“å†…å®¹ä¸€ä½“åŒ–

### 1.2 äº§å“å®šä½
- **ç±»å‹**: ä¸ªäººå‘ AI é•¿æ–‡åˆ›ä½œå·¥ä½œå°
- **å¹³å°**: PWAä¼˜å…ˆï¼ŒDesktopä¼˜å…ˆä½“éªŒ
- **åœºæ™¯**: 2000å­—+é•¿æ–‡ï¼Œå­¦æœ¯ä¸åˆ›ä½œåŒæ¨¡å¼
- **å·®å¼‚åŒ–**: ç»“åˆæœ€æ–°React 19 RSCæŠ€æœ¯ï¼Œå®ç°"æ— äººå€¼å®ˆ"å†™ä½œå¾ªç¯

---

## 2. ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯

### 2.1 ç”¨æˆ·ç”»åƒ

| ç”¨æˆ·ç±»å‹ | å…¸å‹åœºæ™¯ | æ ¸å¿ƒç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ |
|---------|----------|----------|----------|
| **ç ”ç©¶ç”Ÿ/å­¦è€…** | æ’°å†™ç»¼è¿°ã€è®ºæ–‡è‰ç¨¿ | å¼•ç”¨æ ¼å¼å¤æ‚ï¼Œä¿®æ”¹è½®æ¬¡å¤šï¼ŒæŸ¥é‡å‹åŠ› | è‡ªåŠ¨å¼•ç”¨æ ¡éªŒ+ç‰ˆæœ¬ç®¡ç†+è´¨é‡å¾ªç¯ |
| **çŸ¥è¯†å‹åšä¸»** | æ—¥æ›´åšå®¢/ä¸“æ  | æ„æ€è€—æ—¶ï¼Œæ’ç‰ˆç¹çï¼Œèµ„æ–™æœç´¢åˆ†å¿ƒ | ä¸€é”®ç”Ÿæˆ+è‡ªåŠ¨æ ¡éªŒ+å¤šåœºæ™¯è½¬åŒ– |
| **äº§å“ç»ç†** | å†™PRDã€éœ€æ±‚æ–‡æ¡£ | ç»“æ„åŒ–è¾“å‡º&å¿«é€Ÿè¿­ä»£ | æµç¨‹æ¨¡æ¿+æ‰¹é‡ä¿®æ”¹+æ ¼å¼åŒ–å·¥å…· |
| **ä¸“ä¸šä½œå®¶** | é•¿ç¯‡å†…å®¹åˆ›ä½œ | é€»è¾‘è¿è´¯æ€§ï¼Œè´¨é‡ä¸€è‡´æ€§ | å¾ªç¯å¼•æ“+é£æ ¼å­¦ä¹ +å†…å®¹ä¼˜åŒ– |

### 2.2 æ ¸å¿ƒç”¨æˆ·éœ€æ±‚

1. **ä¸€æ¬¡æ€§ç”Ÿæˆå¯ç”¨åˆç¨¿** - é¿å…ç©ºç™½ææƒ§ï¼Œå¿«é€Ÿå¯åŠ¨
2. **è‡ªåŠ¨å¾ªç¯å®¡æ ¡** - Planâ†’Draftâ†’Citationâ†’Grammarâ†’Readabilityâ‰¥70
3. **å³ç‚¹å³æ”¹** - é€‰ä¸­æ–‡æœ¬åç›´æ¥æ”¹å†™/æ‰©å†™/ç¿»è¯‘
4. **å¼•ç”¨ç®¡ç†** - ä¸€é”®æ’å…¥GB/T 7714æˆ–APAæ ¼å¼ï¼Œå®æ—¶æ ¡éªŒçœŸä¼ª
5. **æµç¨‹é€æ˜** - å®Œæ•´ç‰ˆæœ¬æ ‘å¯å¯¹æ¯”ã€å›é€€ã€åˆ†æ”¯ç®¡ç†
6. **è·¨åœºæ™¯è½¬åŒ–** - è®ºæ–‡â†’åšå®¢â†’æ¨æ–‡ä¸€é”®è½¬æ¢

### 2.3 ç”¨æˆ·æ—…ç¨‹

1. **Landing**: é€‰æ‹©ç©ºç™½/æ¨¡æ¿ â†’ è¾“å…¥ä¸»é¢˜æˆ–ç‚¹Promptå»ºè®®
2. **Draft Seed**: AIç”Ÿæˆå¤§çº²&æ®µè½éª¨æ¶ï¼›æµç¨‹æ¡æ˜¾ç¤ºPlan&DraftèŠ‚ç‚¹
3. **å¾ªç¯å†™ä½œ**: è‡ªåŠ¨è‡ªæ£€å¾ªç¯ï¼›ç”¨æˆ·å¯éšæ—¶æ’å…¥Promptæˆ–æ‰‹åŠ¨ç¼–è¾‘
4. **Review Mode**: é¡¶éƒ¨åˆ‡æ¢ï¼›æ°”æ³¡æ ‡è®°é”™è¯¯ï¼›ä¸€é”®ä¿®å¤
5. **Multi-Scene Export**: é€‰æ‹©æ ¼å¼æˆ–åŒæ­¥åˆ°é›†æˆ(Notionã€ArXiv)

---

## 3. å¸‚åœºåˆ†æä¸ç«å“

### 3.1 ä¸»è¦ç«å“åˆ†æ

| ç«å“ | æ ¸å¿ƒä¼˜åŠ¿ | å±€é™æ€§ | æˆ‘ä»¬çš„å·®å¼‚åŒ– |
|------|----------|--------|-------------|
| **Stanford STORM** | å¤šAgentåä½œï¼Œå¼ºå¤§researchèƒ½åŠ› | ç¼ºä¹å®æ—¶ç¼–è¾‘ï¼ŒUIä½“éªŒä¸€èˆ¬ | å®æ—¶ç¼–è¾‘å™¨+å¾ªç¯å¼•æ“+æ›´å¥½çš„UI |
| **Jenni AI** | ä¸“ä¸šå­¦æœ¯å†™ä½œï¼Œå¼•ç”¨ç®¡ç†å®Œå–„ | å•ä¸€åœºæ™¯ï¼Œç¼ºä¹è‡ªåŠ¨åŒ–æµç¨‹ | å¤šåœºæ™¯è½¬åŒ–+è‡ªåŠ¨å¾ªç¯å®¡æ ¡ |
| **Grammarly** | è¯­æ³•æ£€æŸ¥å’Œå†™ä½œå»ºè®®æˆç†Ÿ | éç”Ÿæˆå¼ï¼Œéœ€è¦äººå·¥å†™ä½œ | ç”Ÿæˆå¼+è‡ªåŠ¨åŒ–+è´¨é‡ä¿éšœ |
| **Notion AI** | é›†æˆåº¦é«˜çš„å†™ä½œåŠ©æ‰‹ | é€šç”¨æ€§å¼ºä½†ä¸“ä¸šæ€§ä¸è¶³ | ä¸“ä¸šå­¦æœ¯å†™ä½œ+å¼•ç”¨æ ¡éªŒ |

### 3.2 å¸‚åœºæœºä¼š

- **æ—¶æœºä¼˜åŠ¿**: 2025å¹´React 19 RSCæŠ€æœ¯æˆç†Ÿï¼Œå¯å®ç°æ›´å¥½çš„æ€§èƒ½
- **æŠ€æœ¯ä¼˜åŠ¿**: Server-Firstæ¶æ„ï¼Œæ›´å¿«çš„é¦–å±åŠ è½½å’Œæ›´å¥½çš„SEO
- **åŠŸèƒ½å·®å¼‚**: å¾ªç¯è‡ªæ£€å¼•æ“ï¼Œè‡ªåŠ¨åŒ–ç¨‹åº¦æ›´é«˜
- **ç”¨æˆ·ä½“éªŒ**: åŸºäºshadcn/ui + 21st.devç»„ä»¶ï¼Œç°ä»£åŒ–UIè®¾è®¡

---

## 4. æ ¸å¿ƒåŠŸèƒ½è§„åˆ’

### 4.1 åŠŸèƒ½ä¼˜å…ˆçº§çŸ©é˜µ

| åŠŸèƒ½æ¨¡å— | ä¼˜å…ˆçº§ | MVPç‰ˆæœ¬ | V1.0ç‰ˆæœ¬ | V2.0ç‰ˆæœ¬ |
|----------|--------|---------|----------|----------|
| **å¾ªç¯ç”Ÿæˆå¼•æ“** | P0 | âœ… Planâ†’Draftâ†’Grammarâ†’Readability | + Citationæ£€æŸ¥ | + å¤šè½®ä¼˜åŒ– |
| **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨** | P0 | âœ… TipTapåŸºç¡€åŠŸèƒ½ | + ç°å±‚é¢„è§ˆ | + åä½œç¼–è¾‘ |
| **æµç¨‹æ¡å¯è§†åŒ–** | P0 | âœ… çº¿æ€§æµç¨‹æ˜¾ç¤º | + åˆ†æ”¯å›æ»š | + å¹¶è¡Œå¤„ç† |
| **AIèŠå¤©é¢æ¿** | P1 | âœ… åŸºç¡€å¯¹è¯ | + Slashå‘½ä»¤ | + ä¸Šä¸‹æ–‡ç†è§£ |
| **å¼•ç”¨æ ¡éªŒç³»ç»Ÿ** | P1 | âŒ | âœ… DOI/PMIDéªŒè¯ | + æ‰¹é‡æ ¡éªŒ |
| **å¤šåœºæ™¯è½¬åŒ–** | P2 | âŒ | âŒ | âœ… è®ºæ–‡â†’åšå®¢â†’æ¨æ–‡ |
| **PWAç¦»çº¿åŠŸèƒ½** | P2 | âŒ | âŒ | âœ… Service Worker |

### 4.2 æ ¸å¿ƒAgentç³»ç»Ÿ

```mermaid
graph TB
    A[ä¸»æ§Agent] --> B[å†™ä½œAgent]
    A --> C[æ–‡çŒ®Agent]
    A --> D[å·¥å…·Agent]
    
    B --> B1[å­¦æœ¯è®ºæ–‡æ¨¡å¼]
    B --> B2[åšå®¢æ¨¡å¼]
    B --> B3[ç¤¾äº¤åª’ä½“æ¨¡å¼]
    
    C --> C1[Google Scholaré›†æˆ]
    C --> C2[PubMedé›†æˆ]
    C --> C3[å¼•ç”¨æ ¼å¼åŒ–]
    
    D --> D1[æ ¼å¼åŒ–å·¥å…·]
    D --> D2[å›¾è¡¨ç”Ÿæˆ]
    D --> D3[æ•°æ®å¤„ç†]
```

### 4.3 æ•°æ®æ¨¡å‹è®¾è®¡

```typescript
// æ ¸å¿ƒæ•°æ®ç»“æ„
interface Document {
  id: string
  title: string
  content: string
  status: WorkflowStatus
  nodes: WorkflowNode[]
  metadata: DocumentMetadata
  createdAt: Date
  updatedAt: Date
}

interface WorkflowNode {
  id: string
  type: "Plan" | "Draft" | "Citation" | "Grammar" | "Readability" | "UserEdit"
  status: "pending" | "running" | "pass" | "fail"
  content?: string
  metrics?: NodeMetrics
  timestamp: Date
  branch?: string
  parentId?: string
}

interface NodeMetrics {
  readabilityScore?: number      // Flesch-Kincaidåˆ†æ•°
  grammarErrors?: number         // è¯­æ³•é”™è¯¯æ•°é‡
  citationCount?: number         // å¼•ç”¨æ•°é‡
  wordCount?: number            // å­—æ•°ç»Ÿè®¡
  tokenUsage?: number           // Tokenæ¶ˆè€—
  processingTime?: number       // å¤„ç†æ—¶é—´(ms)
}

interface Citation {
  id: string
  doi?: string
  pmid?: string
  title: string
  authors: string[]
  journal?: string
  year: number
  verified: boolean
  format: "GB/T" | "APA" | "MLA"
}
```

---

## 5. å¾ªç¯å¼•æ“è®¾è®¡

### 5.1 å·¥ä½œæµçŠ¶æ€æœº

```typescript
enum WorkflowStatus {
  IDLE = "idle",
  PLANNING = "planning", 
  DRAFTING = "drafting",
  CITATION_CHECK = "citation_check",
  GRAMMAR_CHECK = "grammar_check", 
  READABILITY_CHECK = "readability_check",
  DONE = "done",
  FAILED = "failed"
}

// çŠ¶æ€è½¬æ¢è§„åˆ™
const WORKFLOW_TRANSITIONS = {
  idle: ['planning'],
  planning: ['drafting', 'failed'],
  drafting: ['citation_check', 'failed'],
  citation_check: ['grammar_check', 'drafting', 'failed'],
  grammar_check: ['readability_check', 'drafting', 'failed'],
  readability_check: ['done', 'drafting', 'failed'],
  done: ['planning', 'idle'],
  failed: ['planning', 'idle']
}
```

### 5.2 è´¨é‡é˜ˆå€¼é…ç½®

```typescript
interface QualityThresholds {
  readabilityScore: number      // é»˜è®¤70åˆ†
  maxGrammarErrors: number      // é»˜è®¤5ä¸ª
  minCitationCount: number      // é»˜è®¤æ ¹æ®æ–‡æ¡£é•¿åº¦
  maxRetries: number           // é»˜è®¤3æ¬¡
  timeoutSeconds: number       // é»˜è®¤60ç§’
}

// æ™ºèƒ½é˜ˆå€¼è°ƒæ•´
const adaptiveThresholds = (documentType: string, userLevel: string) => {
  const base = DEFAULT_THRESHOLDS
  
  if (documentType === 'academic') {
    base.readabilityScore = 65  // å­¦æœ¯æ–‡æ¡£è¦æ±‚ç¨ä½
    base.minCitationCount = Math.floor(wordCount / 200)
  }
  
  if (userLevel === 'expert') {
    base.maxRetries = 5
    base.readabilityScore += 5
  }
  
  return base
}
```

### 5.3 å¤±è´¥å›é€€ç­–ç•¥

```typescript
class RetryManager {
  private retryCount = 0
  private readonly maxRetries = 3
  private readonly backoffMs = [1000, 2000, 4000] // æŒ‡æ•°é€€é¿
  
  async executeWithRetry(fn: () => Promise<any>, nodeId: string) {
    try {
      const result = await fn()
      this.retryCount = 0  // æˆåŠŸåé‡ç½®
      return result
    } catch (error) {
      if (this.retryCount < this.maxRetries) {
        await this.delay(this.backoffMs[this.retryCount])
        this.retryCount++
        
        // è®°å½•é‡è¯•
        await this.logRetry(nodeId, this.retryCount, error)
        
        return this.executeWithRetry(fn, nodeId)
      } else {
        // é‡è¯•æ¬¡æ•°è€—å°½ï¼Œè¯·æ±‚ç”¨æˆ·å¹²é¢„
        throw new MaxRetryError(error, this.retryCount)
      }
    }
  }
  
  private async delay(ms: number) {
    return new Promise(resolve => setTimeout(resolve, ms))
  }
}
```

---

## 6. ç”¨æˆ·ç•Œé¢è§„èŒƒ

### 6.1 å¸ƒå±€æ¶æ„ (Holy Grail + React 19 RSC)

```typescript
// app/document/[id]/layout.tsx - Server Component
export default async function DocumentLayout({
  children,
  params
}: {
  children: React.ReactNode
  params: { id: string }
}) {
  // æœåŠ¡ç«¯é¢„å–åŸºç¡€æ•°æ®
  const document = await getDocument(params.id)
  
  return (
    <div className="h-screen flex flex-col">
      {/* TopBar - Server Component */}
      <TopBar title={document.title} documentId={params.id} />
      
      {/* ProcessBar - Server Component with streaming */}
      <Suspense fallback={<ProcessBarSkeleton />}>
        <ProcessBar documentId={params.id} />
      </Suspense>
      
      {/* Main Content Area */}
      <div className="flex-1 flex overflow-hidden">
        {children}
      </div>
    </div>
  )
}
```

### 6.2 å“åº”å¼è®¾è®¡è§„èŒƒ

| å±å¹•å°ºå¯¸ | å¸ƒå±€ç­–ç•¥ | Chaté¢æ¿ | å·¥å…·æ¡ | ProcessBar |
|---------|----------|----------|--------|------------|
| **Desktop â‰¥1024px** | ä¸‰æ å¸ƒå±€ | å›ºå®šå³ä¾§24% | æµ®åŠ¨è¦†ç›– | å®Œæ•´æ˜¾ç¤º |
| **Tablet 768-1023px** | ä¸»ç¼–è¾‘å™¨+æŠ½å±‰ | æŠ½å±‰å¼æ»‘å‡º | Iconæ¨¡å¼ | å¯æ»šåŠ¨ |
| **Mobile <768px** | å…¨å±ç¼–è¾‘ | FABåœ†é’® | åº•éƒ¨å·¥å…·æ  | é¡¶éƒ¨æŠ½å±‰ |

### 6.3 21st.devç»„ä»¶é€‰å‹

#### æ¨èä½¿ç”¨çš„å…·ä½“ç»„ä»¶

| ç»„ä»¶ç±»å‹ | 21st.devç»„ä»¶ | é€‚ç”¨åœºæ™¯ | è‡ªå®šä¹‰éœ€æ±‚ |
|----------|--------------|----------|------------|
| **AI Chat** | AI Chat Components (30ç§) | ChatPanelä¸»ä½“ | æ·»åŠ Slashå‘½ä»¤æ”¯æŒ |
| **Sidebar** | Sidebar Components (10ç§) | å“åº”å¼ä¾§è¾¹æ  | é›†æˆæ–‡æ¡£æ ‘ |
| **Buttons** | Button Components (130ç§) | å·¥å…·æ æŒ‰é’® | æ·»åŠ çŠ¶æ€æŒ‡ç¤º |
| **Inputs** | Input Components (102ç§) | Promptè¾“å…¥æ¡† | è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ |
| **Loaders** | Spinner Loaders (21ç§) | èŠ‚ç‚¹åŠ è½½çŠ¶æ€ | è‡ªå®šä¹‰åŠ¨ç”»æ—¶é•¿ |

### 6.4 Tailwind CSS v4.0 ä¸»é¢˜é…ç½®

```css
/* globals.css - åŸºäº2025å¹´æœ€æ–°æ ‡å‡† */
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

:root {
  /* åŸºç¡€è‰²å½© - ä½¿ç”¨OKLCHè‰²å½©ç©ºé—´ */
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --primary: oklch(0.5 0.2 250);
  --secondary: oklch(0.7 0.1 200);
  
  /* åŠŸèƒ½è‰²å½© */
  --success: oklch(0.65 0.15 140);
  --warning: oklch(0.75 0.15 60);
  --error: oklch(0.65 0.15 20);
  
  /* æµç¨‹èŠ‚ç‚¹è‰²å½© */
  --node-pending: oklch(0.8 0.05 60);
  --node-running: oklch(0.7 0.15 220);
  --node-pass: oklch(0.7 0.15 140);
  --node-fail: oklch(0.7 0.15 20);
}
```

---

## 7. æŠ€æœ¯æ¶æ„ï¼ˆ2025ç‰ˆï¼‰

### 7.1 å‰ç«¯æŠ€æœ¯æ ˆ

```typescript
// 2025å¹´7æœˆæœ€æ–°æŠ€æœ¯é€‰å‹
const FRONTEND_STACK = {
  // æ ¸å¿ƒæ¡†æ¶
  framework: "Next.js 15",                    // React 19 + RSC + PPR
  runtime: "React 19",                        // Server Componentsç¨³å®šç‰ˆ
  
  // çŠ¶æ€ç®¡ç† (åˆ†ç¦»å…³æ³¨ç‚¹)
  clientState: "Zustand v5",                  // å®¢æˆ·ç«¯UIçŠ¶æ€
  serverState: "TanStack Query v5",           // æœåŠ¡ç«¯æ•°æ®çŠ¶æ€
  
  // UIç»„ä»¶åº“
  uiLibrary: "shadcn/ui",                     // React 19å…¼å®¹ç‰ˆ
  styling: "Tailwind CSS v4.0",              // @themeæŒ‡ä»¤æ”¯æŒ
  components: "21st.dev AI Chat Components",  // ç°æˆAIèŠå¤©ç»„ä»¶
  animation: "tw-animate-css",                // æ–°æ¨èåŠ¨ç”»åº“
  
  // ä¸“ä¸šç»„ä»¶
  textEditor: "TipTap v2",                    // æœ€æˆç†Ÿçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
  
  // PWA & ç¦»çº¿
  pwa: "Workbox v8",                          // æœ€æ–°Service Workeræ–¹æ¡ˆ
  storage: "IndexedDB + Cache API",           // ç¦»çº¿æ•°æ®å­˜å‚¨
  
  // ç±»å‹å®‰å…¨
  typeSystem: "TypeScript 5.x",              // æœ€æ–°TSç‰ˆæœ¬
  apiClient: "tRPC v11",                      // ç±»å‹å®‰å…¨çš„API
} as const
```

### 7.2 æ¶æ„åŸåˆ™

#### 1. Server-First Development
```typescript
// åˆ©ç”¨React 19 RSCå‡å°‘å®¢æˆ·ç«¯JS Bundle
// é™æ€å†…å®¹å®Œå…¨åœ¨æœåŠ¡ç«¯æ¸²æŸ“
export default async function DocumentViewer({ id }: { id: string }) {
  // æœåŠ¡ç«¯æ•°æ®è·å–ï¼Œé›¶å®¢æˆ·ç«¯JS
  const document = await getDocument(id)
  const processNodes = await getProcessNodes(id)
  
  return (
    <div className="prose max-w-none">
      {/* é™æ€å†…å®¹ï¼Œé›¶JS bundle */}
      <ProcessBar nodes={processNodes} />
      <DocumentContent content={document.content} />
    </div>
  )
}
```

#### 2. åˆ†ç¦»å…³æ³¨ç‚¹çš„çŠ¶æ€ç®¡ç†
```typescript
// TanStack Query: æœåŠ¡ç«¯çŠ¶æ€
const useDocumentQuery = (id: string) => {
  return useQuery({
    queryKey: ['document', id],
    queryFn: () => fetchDocument(id),
    staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿç¼“å­˜
    gcTime: 10 * 60 * 1000,   // 10åˆ†é’Ÿåƒåœ¾å›æ”¶
  })
}

// Zustand: å®¢æˆ·ç«¯UIçŠ¶æ€
const useUIStore = create<UIState>((set, get) => ({
  // ç¼–è¾‘å™¨çŠ¶æ€
  isAutoRunning: false,
  selectedText: null,
  floatingToolbarVisible: false,
  
  // é¢æ¿çŠ¶æ€
  chatPanelCollapsed: false,
  processPanelVisible: true,
  
  // åŠ¨ä½œ
  toggleAutoRun: () => set((state) => ({ 
    isAutoRunning: !state.isAutoRunning 
  })),
  
  setSelectedText: (text: string | null, range?: Range) => set({
    selectedText: text,
    floatingToolbarVisible: !!text
  }),
}))
```

### 7.3 é¡¹ç›®ç»“æ„

```
ai-writing-tool/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ web/                          # Next.js 15ä¸»åº”ç”¨
â”‚       â”œâ”€â”€ app/                      # App Router (React 19)
â”‚       â”‚   â”œâ”€â”€ (dashboard)/          # è·¯ç”±ç»„
â”‚       â”‚   â”‚   â”œâ”€â”€ document/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚       â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx         # æ–‡æ¡£é¡µé¢
â”‚       â”‚   â”‚   â”‚       â””â”€â”€ layout.tsx       # å¸ƒå±€
â”‚       â”‚   â”‚   â””â”€â”€ page.tsx          # é¦–é¡µ
â”‚       â”‚   â”œâ”€â”€ api/                  # API Routes
â”‚       â”‚   â”‚   â”œâ”€â”€ trpc/             # tRPCå¤„ç†å™¨
â”‚       â”‚   â”‚   â””â”€â”€ auth/             # è®¤è¯ç›¸å…³
â”‚       â”‚   â”œâ”€â”€ globals.css           # Tailwind v4é…ç½®
â”‚       â”‚   â””â”€â”€ layout.tsx            # æ ¹å¸ƒå±€
â”‚       â”œâ”€â”€ components/               # Reactç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ server/               # Server Components
â”‚       â”‚   â”‚   â”œâ”€â”€ document-viewer.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ process-bar.tsx
â”‚       â”‚   â”‚   â””â”€â”€ chat-panel.tsx
â”‚       â”‚   â”œâ”€â”€ client/               # Client Components
â”‚       â”‚   â”‚   â”œâ”€â”€ document-editor.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ floating-toolbar.tsx
â”‚       â”‚   â”‚   â””â”€â”€ ui-controls.tsx
â”‚       â”‚   â””â”€â”€ ui/                   # shadcn/uiåŸºç¡€ç»„ä»¶
â”‚       â”‚       â”œâ”€â”€ button.tsx
â”‚       â”‚       â”œâ”€â”€ input.tsx
â”‚       â”‚       â””â”€â”€ dialog.tsx
â”‚       â”œâ”€â”€ lib/                      # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ api/                  # APIå®¢æˆ·ç«¯
â”‚       â”‚   â”œâ”€â”€ stores/               # Zustand stores
â”‚       â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰hooks
â”‚       â”‚   â””â”€â”€ utils.ts              # é€šç”¨å·¥å…·
â”‚       â””â”€â”€ types/                    # TypeScriptç±»å‹
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ editor/                       # TipTapç¼–è¾‘å™¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ extensions/               # è‡ªå®šä¹‰æ‰©å±•
â”‚   â”‚   â”œâ”€â”€ components/               # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ types.ts                  # ç¼–è¾‘å™¨ç±»å‹
â”‚   â”œâ”€â”€ api-client/                   # tRPCå®¢æˆ·ç«¯
â”‚   â””â”€â”€ shared/                       # å…±äº«ç±»å‹å’Œå·¥å…·
â”œâ”€â”€ backend/                          # ç°æœ‰FastAPIåç«¯
â””â”€â”€ package.json                      # Monorepoé…ç½®
```

### 7.4 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 1. React 19 RSCä¼˜åŒ–
```typescript
// åˆ©ç”¨Server Componentsé¢„æ¸²æŸ“é™æ€å†…å®¹
export async function ProcessBar({ documentId }: { documentId: string }) {
  // æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œæ— å®¢æˆ·ç«¯è¯·æ±‚
  const nodes = await getProcessNodes(documentId)
  
  return (
    <div className="flex items-center gap-2 p-4">
      {nodes.map(node => (
        <ProcessNode 
          key={node.id} 
          node={node}
          // å®¢æˆ·ç«¯äº¤äº’éƒ¨åˆ†ä½¿ç”¨Client Component
        />
      ))}
    </div>
  )
}
```

#### 2. æ™ºèƒ½ç¼“å­˜ç­–ç•¥
```typescript
// TanStack Queryé…ç½®
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,      // 5åˆ†é’Ÿå†…è®¤ä¸ºæ•°æ®æ–°é²œ
      gcTime: 10 * 60 * 1000,        // 10åˆ†é’Ÿååƒåœ¾å›æ”¶
      retry: (failureCount, error) => {
        // æ™ºèƒ½é‡è¯•ç­–ç•¥
        if (error.status === 404) return false
        return failureCount < 3
      },
    },
  },
})

// Redisç¼“å­˜å±‚ï¼ˆåç«¯ï¼‰
const CACHE_CONFIG = {
  documents: {
    ttl: 60 * 60,              // 1å°æ—¶
    pattern: "doc:{id}",
  },
  citations: {
    ttl: 7 * 24 * 60 * 60,     // 7å¤©
    pattern: "cite:{doi}",
  },
  workflows: {
    ttl: 30 * 60,              // 30åˆ†é’Ÿ
    pattern: "workflow:{docId}",
  },
}
```

### 7.5 PWAå®ç°æ–¹æ¡ˆ

```typescript
// lib/sw-config.ts - Workbox v8é…ç½®
import { precacheAndRoute, cleanupOutdatedCaches } from 'workbox-precaching'
import { registerRoute } from 'workbox-routing'
import { StaleWhileRevalidate, CacheFirst, NetworkFirst } from 'workbox-strategies'

// é¢„ç¼“å­˜é™æ€èµ„æº
precacheAndRoute(self.__WB_MANIFEST)
cleanupOutdatedCaches()

// æ–‡æ¡£å†…å®¹ç¼“å­˜ç­–ç•¥
registerRoute(
  ({ url }) => url.pathname.startsWith('/api/documents'),
  new StaleWhileRevalidate({
    cacheName: 'documents-cache-v1',
    plugins: [
      {
        cacheKeyWillBeUsed: async ({ request }) => {
          // ç¼“å­˜keyåŒ…å«ç‰ˆæœ¬ä¿¡æ¯
          return `${request.url}?v=${await getDocumentVersion()}`
        }
      }
    ]
  })
)

// AIç”Ÿæˆå†…å®¹ç¼“å­˜ç­–ç•¥
registerRoute(
  ({ url }) => url.pathname.startsWith('/api/generate'),
  new NetworkFirst({
    cacheName: 'ai-content-cache-v1',
    networkTimeoutSeconds: 10,
    plugins: [
      {
        cacheWillUpdate: async ({ response }) => {
          // åªç¼“å­˜æˆåŠŸçš„AIå“åº”
          return response.status === 200 && response.headers.get('content-type')?.includes('application/json')
        }
      }
    ]
  })
)
```

---

## 8. 21st.devç»„ä»¶é›†æˆ

### 8.1 æ ¸å¿ƒç»„ä»¶é€‰å‹ä¸æ”¹é€ 

#### 1. AI Chatç»„ä»¶é›†æˆ
```typescript
// components/client/chat-panel.tsx
'use client'
import { AIChatComponent } from '@21st-dev/ai-chat'
import { useUIStore } from '@/lib/stores/ui-store'
import { useChatMutation } from '@/lib/api/chat-queries'

export function ChatPanel({ documentId }: { documentId: string }) {
  const { chatPanelCollapsed } = useUIStore()
  const sendMessage = useChatMutation(documentId)
  
  return (
    <div className={cn(
      "w-[24%] max-w-[380px] min-w-[300px] border-l flex flex-col",
      chatPanelCollapsed && "w-12"
    )}>
      <AIChatComponent
        onMessage={(message) => sendMessage.mutate(message)}
        placeholder="è¾“å…¥æŒ‡ä»¤æˆ–ä½¿ç”¨ / å¿«æ·å‘½ä»¤..."
        // é›†æˆ21st.devç»„ä»¶çš„è‡ªå®šä¹‰æ ·å¼
        className="h-full"
        theme="modern"
        enableSlashCommands
        commands={[
          { name: 'rewrite', description: 'é‡å†™é€‰ä¸­æ–‡æœ¬' },
          { name: 'expand', description: 'æ‰©å±•å†…å®¹' },
          { name: 'cite', description: 'æ·»åŠ å¼•ç”¨' },
        ]}
      />
    </div>
  )
}
```

#### 2. æŒ‰é’®ç»„ä»¶å®šåˆ¶
```typescript
// components/ui/process-node-button.tsx
import { Button } from '@21st-dev/button-modern'
import { cn } from '@/lib/utils'

interface ProcessNodeButtonProps {
  node: WorkflowNode
  onClick: () => void
  className?: string
}

export function ProcessNodeButton({ node, onClick, className }: ProcessNodeButtonProps) {
  const statusColors = {
    pending: 'bg-gray-200 text-gray-600',
    running: 'bg-blue-500 text-white animate-pulse',
    pass: 'bg-green-500 text-white',
    fail: 'bg-red-500 text-white'
  }
  
  return (
    <Button
      variant="ghost"
      size="sm"
      onClick={onClick}
      className={cn(
        "relative rounded-full min-w-[100px]",
        statusColors[node.status],
        className
      )}
    >
      {/* 21st.devæŒ‰é’®åŸºç¡€ä¸Šæ·»åŠ çŠ¶æ€æŒ‡ç¤ºå™¨ */}
      <div className="absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white">
        <div className={cn(
          "w-full h-full rounded-full",
          statusColors[node.status].split(' ')[0]
        )} />
      </div>
      
      {node.type}
    </Button>
  )
}
```

### 8.2 ç»„ä»¶æ”¹é€ æŒ‡å—

#### 1. ä¿æŒ21st.devç»„ä»¶çš„è®¾è®¡è¯­è¨€
```typescript
// ç»Ÿä¸€è®¾è®¡token
const DESIGN_TOKENS = {
  // ä»21st.devç»„ä»¶ä¸­æå–çš„è®¾è®¡è§„èŒƒ
  borderRadius: {
    sm: '0.375rem',
    md: '0.5rem',
    lg: '0.75rem',
  },
  shadows: {
    sm: '0 1px 2px 0 rgb(0 0 0 / 0.05)',
    md: '0 4px 6px -1px rgb(0 0 0 / 0.1)',
    lg: '0 10px 15px -3px rgb(0 0 0 / 0.1)',
  },
  animations: {
    duration: '200ms',
    timing: 'cubic-bezier(0.4, 0, 0.2, 1)',
  }
}
```

#### 2. æ‰©å±•ç»„ä»¶åŠŸèƒ½
```typescript
// åœ¨21st.devåŸºç¡€ç»„ä»¶ä¸Šæ·»åŠ ä¸šåŠ¡é€»è¾‘
import { SidebarBase } from '@21st-dev/sidebar-modern'

export function DocumentSidebar({ documentId }: { documentId: string }) {
  const { data: documentTree } = useDocumentTreeQuery(documentId)
  
  return (
    <SidebarBase
      // ä½¿ç”¨21st.devçš„åŸºç¡€æ ·å¼
      className="w-64 border-r"
      collapsible
    >
      {/* æ·»åŠ æˆ‘ä»¬ç‰¹å®šçš„æ–‡æ¡£æ ‘åŠŸèƒ½ */}
      <DocumentTree data={documentTree} />
      
      {/* ä¿æŒ21st.devçš„è§†è§‰é£æ ¼ */}
      <div className="mt-auto p-4">
        <Button variant="outline" size="sm" className="w-full">
          å¯¼å‡ºæ–‡æ¡£
        </Button>
      </div>
    </SidebarBase>
  )
}
```

---

## 9. å®ç°è·¯çº¿å›¾

### 9.1 é‡Œç¨‹ç¢‘è§„åˆ’

| é‡Œç¨‹ç¢‘ | ç›®æ ‡ | åŠŸèƒ½èŒƒå›´ | æ—¶é—´ | æŠ€æœ¯é‡ç‚¹ |
|-------|------|----------|------|----------|
| **M0 æ¶æ„å‡çº§** | 2025æŠ€æœ¯æ ˆè¿ç§» | Next.js 15 + React 19 + shadcn/ui v4 | 2å‘¨ | RSCæ¶æ„ã€Tailwind v4 |
| **M1 æ ¸å¿ƒå¼•æ“** | å¾ªç¯å†™ä½œå¼•æ“ | Planâ†’Draftâ†’Grammarâ†’Readability | 3å‘¨ | XStateçŠ¶æ€æœºã€TanStack Query |
| **M2 ç°ä»£UI** | 21st.devé›†æˆ | Holy Grailå¸ƒå±€ + AI Chatç»„ä»¶ | 3å‘¨ | ç»„ä»¶é›†æˆã€å“åº”å¼è®¾è®¡ |
| **M3 é«˜çº§åŠŸèƒ½** | å¼•ç”¨ä¸PWA | DOIæ ¡éªŒ + ç¦»çº¿åŠŸèƒ½ + æ€§èƒ½ä¼˜åŒ– | 2å‘¨ | Workbox v8ã€IndexedDB |
| **M4 å¤šåœºæ™¯** | å†…å®¹è½¬åŒ– | è®ºæ–‡â†’åšå®¢â†’æ¨æ–‡è½¬æ¢ | 2å‘¨ | Agentç³»ç»Ÿã€æ ¼å¼è½¬æ¢ |

### 9.2 è¯¦ç»†å¼€å‘è®¡åˆ’

#### M0: æ¶æ„å‡çº§ (2å‘¨)
**ç›®æ ‡**: å»ºç«‹åŸºäº2025å¹´æœ€æ–°æŠ€æœ¯çš„ç°ä»£åŒ–æ¶æ„

**ç¬¬1å‘¨**:
- [ ] Next.js 15é¡¹ç›®åˆå§‹åŒ–ï¼Œé…ç½®App Router
- [ ] React 19ç¯å¢ƒé…ç½®ï¼Œå¯ç”¨Server Components
- [ ] Tailwind CSS v4.0é…ç½®ï¼Œä½¿ç”¨@themeæŒ‡ä»¤
- [ ] shadcn/uiç»„ä»¶åº“é›†æˆï¼ŒReact 19å…¼å®¹ç‰ˆæœ¬
- [ ] TypeScript 5.xé…ç½®ï¼Œä¸¥æ ¼ç±»å‹æ£€æŸ¥

**ç¬¬2å‘¨**:
- [ ] Zustand v5çŠ¶æ€ç®¡ç†é…ç½®
- [ ] TanStack Query v5é›†æˆï¼Œåˆ†ç¦»æœåŠ¡ç«¯çŠ¶æ€
- [ ] tRPC v11 APIå±‚é…ç½®ï¼Œç±»å‹å®‰å…¨é€šä¿¡
- [ ] åŸºç¡€CI/CDæµç¨‹ï¼ŒVerceléƒ¨ç½²é…ç½®
- [ ] æ€§èƒ½ç›‘æ§å·¥å…·é›†æˆï¼ŒCore Web Vitals

#### M1: æ ¸å¿ƒå¼•æ“ (3å‘¨)
**ç›®æ ‡**: å®ç°è‡ªåŠ¨åŒ–å†™ä½œå¾ªç¯å¼•æ“

**ç¬¬1å‘¨**:
- [ ] XStateçŠ¶æ€æœºè®¾è®¡ï¼Œå·¥ä½œæµçŠ¶æ€ç®¡ç†
- [ ] FastAPIåç«¯æ¥å£ä¼˜åŒ–ï¼Œæ”¯æŒæ–°å‰ç«¯æ¶æ„
- [ ] WebSocketå®æ—¶é€šä¿¡ï¼ŒçŠ¶æ€åŒæ­¥æœºåˆ¶
- [ ] åŸºç¡€Agentå®ç°ï¼šPlanå’ŒDrafté˜¶æ®µ
- [ ] ç®€å•UIæµ‹è¯•ï¼ŒéªŒè¯çŠ¶æ€æµè½¬

**ç¬¬2å‘¨**:
- [ ] Grammaræ£€æŸ¥é›†æˆï¼ŒLLM APIè°ƒç”¨
- [ ] Readabilityç®—æ³•å®ç°ï¼ŒFlesch-Kincaidè®¡åˆ†
- [ ] å¤±è´¥é‡è¯•æœºåˆ¶ï¼ŒæŒ‡æ•°é€€é¿ç­–ç•¥
- [ ] è´¨é‡é˜ˆå€¼é…ç½®ï¼Œæ™ºèƒ½å‚æ•°è°ƒæ•´
- [ ] åç«¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¼‚æ­¥å¤„ç†æ”¯æŒ

**ç¬¬3å‘¨**:
- [ ] å¾ªç¯é€»è¾‘å®Œå–„ï¼Œè‡ªåŠ¨å›é€€æœºåˆ¶
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼Œç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- [ ] å•å…ƒæµ‹è¯•ç¼–å†™ï¼Œæ ¸å¿ƒé€»è¾‘è¦†ç›–
- [ ] é›†æˆæµ‹è¯•ï¼Œç«¯åˆ°ç«¯å·¥ä½œæµéªŒè¯

#### M2: ç°ä»£UI (3å‘¨)
**ç›®æ ‡**: æ„å»ºåŸºäº21st.devç»„ä»¶çš„ç°ä»£åŒ–ç•Œé¢

**ç¬¬1å‘¨**:
- [ ] Holy Grailå¸ƒå±€å®ç°ï¼Œå“åº”å¼è®¾è®¡
- [ ] 21st.dev AI Chatç»„ä»¶é›†æˆå’Œå®šåˆ¶
- [ ] TipTapå¯Œæ–‡æœ¬ç¼–è¾‘å™¨é›†æˆ
- [ ] åŸºç¡€äº¤äº’é€»è¾‘ï¼Œé€‰ä¸­æ–‡æœ¬å·¥å…·æ 
- [ ] ç§»åŠ¨ç«¯é€‚é…ï¼Œè§¦æ‘¸äº¤äº’ä¼˜åŒ–

**ç¬¬2å‘¨**:
- [ ] ProcessBarå¯è§†åŒ–ç»„ä»¶ï¼ŒèŠ‚ç‚¹çŠ¶æ€æ˜¾ç¤º
- [ ] FloatingToolbarå®ç°ï¼Œä¸Šä¸‹æ–‡æ“ä½œ
- [ ] ç°å±‚é¢„è§ˆåŠŸèƒ½ï¼Œå†…å®¹ç¡®è®¤æœºåˆ¶
- [ ] é”®ç›˜å¿«æ·é”®æ”¯æŒï¼Œæå‡æ“ä½œæ•ˆç‡
- [ ] æš—è‰²ä¸»é¢˜æ”¯æŒï¼Œç”¨æˆ·åå¥½è®¾ç½®

**ç¬¬3å‘¨**:
- [ ] åŠ¨ç”»æ•ˆæœå®ç°ï¼Œtw-animate-cssé›†æˆ
- [ ] 21st.devç»„ä»¶æ·±åº¦å®šåˆ¶ï¼Œä¸šåŠ¡åŠŸèƒ½é›†æˆ
- [ ] æ— éšœç¢åŠŸèƒ½æ”¯æŒï¼ŒWCAG 2.1 AAæ ‡å‡†
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼Œå‡å°‘é¦–å±åŠ è½½æ—¶é—´
- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•ï¼Œç•Œé¢äº¤äº’ä¼˜åŒ–

#### M3: é«˜çº§åŠŸèƒ½ (2å‘¨)
**ç›®æ ‡**: å¼•ç”¨æ ¡éªŒç³»ç»Ÿå’ŒPWAç¦»çº¿åŠŸèƒ½

**ç¬¬1å‘¨**:
- [ ] DOI/PMIDéªŒè¯APIé›†æˆï¼ŒCrossRef/PubMed
- [ ] å¼•ç”¨æ ¼å¼åŒ–å¼•æ“ï¼ŒGB/T 7714å’ŒAPAæ”¯æŒ
- [ ] Redisç¼“å­˜ä¼˜åŒ–ï¼Œå¼•ç”¨æ•°æ®ç¼“å­˜
- [ ] æ‰¹é‡å¼•ç”¨å¤„ç†ï¼Œå¼‚æ­¥éªŒè¯é˜Ÿåˆ—
- [ ] å¼•ç”¨æ•°æ®å¯è§†åŒ–ï¼Œå‘½ä¸­ç‡ç›‘æ§

**ç¬¬2å‘¨**:
- [ ] Workbox v8 PWAé…ç½®ï¼ŒService Worker
- [ ] ç¦»çº¿æ•°æ®å­˜å‚¨ï¼ŒIndexedDB + Cache API
- [ ] ç¦»çº¿ç¼–è¾‘åŠŸèƒ½ï¼Œæœ¬åœ°çŠ¶æ€åŒæ­¥
- [ ] ç½‘ç»œçŠ¶æ€æ£€æµ‹ï¼Œè‡ªåŠ¨åŒæ­¥æœºåˆ¶
- [ ] PWAå®‰è£…æç¤ºï¼ŒåŸç”Ÿåº”ç”¨ä½“éªŒ

#### M4: å¤šåœºæ™¯è½¬åŒ– (2å‘¨)
**ç›®æ ‡**: å®ç°è·¨åœºæ™¯å†…å®¹è½¬åŒ–åŠŸèƒ½

**ç¬¬1å‘¨**:
- [ ] å†…å®¹åˆ†æå¼•æ“ï¼Œç»“æ„è¯†åˆ«å’Œæå–
- [ ] æ ¼å¼è½¬æ¢ç®—æ³•ï¼Œè®ºæ–‡â†’åšå®¢â†’æ¨æ–‡
- [ ] å—ä¼—é€‚é…é€»è¾‘ï¼Œè¯­è¨€é£æ ¼è°ƒæ•´
- [ ] å¹³å°ä¼˜åŒ–åŠŸèƒ½ï¼Œå­—æ•°å’Œæ ¼å¼é™åˆ¶
- [ ] è½¬æ¢é¢„è§ˆç•Œé¢ï¼Œç”¨æˆ·ç¡®è®¤æœºåˆ¶

**ç¬¬2å‘¨**:
- [ ] æ‰¹é‡è½¬æ¢åŠŸèƒ½ï¼Œå¤šæ ¼å¼åŒæ—¶è¾“å‡º
- [ ] æ¨¡æ¿ç³»ç»Ÿï¼Œå¸¸ç”¨è½¬æ¢é…ç½®ä¿å­˜
- [ ] é›†æˆæµ‹è¯•ï¼Œå®Œæ•´è½¬æ¢æµç¨‹éªŒè¯
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼Œå¤§æ–‡æ¡£å¤„ç†èƒ½åŠ›
- [ ] ç”¨æˆ·æ–‡æ¡£ï¼ŒåŠŸèƒ½ä½¿ç”¨æŒ‡å—

### 9.3 æŠ€æœ¯å€ºåŠ¡ç®¡ç†

#### 1. æ¶æ„å€ºåŠ¡
- **ç°æœ‰åç«¯é‡æ„**: é€æ­¥è¿ç§»åˆ°æ›´ç°ä»£çš„æ¶æ„æ¨¡å¼
- **æ•°æ®åº“ä¼˜åŒ–**: è€ƒè™‘ä»SQLiteè¿ç§»åˆ°PostgreSQL
- **APIè®¾è®¡**: ç»Ÿä¸€RESTfulå’ŒtRPCæ··åˆæ¶æ„

#### 2. æ€§èƒ½å€ºåŠ¡
- **Bundle Sizeä¼˜åŒ–**: ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- **å›¾åƒä¼˜åŒ–**: Next.js Imageç»„ä»¶å’ŒWebPæ ¼å¼
- **ç¼“å­˜ç­–ç•¥**: å¤šå±‚ç¼“å­˜æ¶æ„ä¼˜åŒ–

#### 3. ç”¨æˆ·ä½“éªŒå€ºåŠ¡
- **åŠ è½½çŠ¶æ€**: éª¨æ¶å±å’Œæ¸è¿›å¼åŠ è½½
- **é”™è¯¯å¤„ç†**: å‹å¥½çš„é”™è¯¯é¡µé¢å’Œæ¢å¤æœºåˆ¶
- **ç”¨æˆ·å¼•å¯¼**: æ–°ç”¨æˆ·onboardingæµç¨‹

---

## 10. é£é™©è¯„ä¼°ä¸ç¼“è§£

### 10.1 æŠ€æœ¯é£é™©

| é£é™©ç±»å‹ | é£é™©æè¿° | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥ |
|---------|----------|------|------|----------|
| **React 19ç¨³å®šæ€§** | æ–°ç‰ˆæœ¬å¯èƒ½å­˜åœ¨æœªçŸ¥bug | ä¸­ | é«˜ | ä¿æŒReact 18å›é€€æ–¹æ¡ˆï¼Œæ¸è¿›å¼å‡çº§ |
| **RSCæ€§èƒ½é—®é¢˜** | Server Componentså¯èƒ½å½±å“å“åº”é€Ÿåº¦ | ä¸­ | ä¸­ | æ€§èƒ½ç›‘æ§ï¼Œå…³é”®è·¯å¾„ä¼˜åŒ– |
| **21st.devç»„ä»¶å…¼å®¹æ€§** | ç¬¬ä¸‰æ–¹ç»„ä»¶å¯èƒ½ä¸æˆ‘ä»¬çš„éœ€æ±‚ä¸åŒ¹é… | é«˜ | ä¸­ | æ·±åº¦å®šåˆ¶ï¼Œå¿…è¦æ—¶è‡ªå»ºç»„ä»¶ |
| **TipTapæ‰©å±•å†²çª** | å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰©å±•å¯èƒ½å†²çª | ä½ | é«˜ | ä¸¥æ ¼æµ‹è¯•ï¼Œç‰ˆæœ¬é”å®š |

### 10.2 ä¸šåŠ¡é£é™©

| é£é™©ç±»å‹ | é£é™©æè¿° | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥ |
|---------|----------|------|------|----------|
| **AI APIæˆæœ¬** | LLMè°ƒç”¨æˆæœ¬å¯èƒ½è¶…å‡ºé¢„ç®— | é«˜ | é«˜ | Tokené¢„ä¼°+é™æµ+åˆ†å±‚è°ƒç”¨ |
| **å¼•ç”¨å‡†ç¡®ç‡** | è‡ªåŠ¨å¼•ç”¨å¯èƒ½å­˜åœ¨é”™è¯¯ | ä¸­ | é«˜ | å¤šé‡éªŒè¯+äººå·¥reviewæç¤º |
| **ç”¨æˆ·æ¥å—åº¦** | è‡ªåŠ¨åŒ–æµç¨‹å¯èƒ½ä¸è¢«ç”¨æˆ·æ¥å— | ä¸­ | ä¸­ | å¯é…ç½®è‡ªåŠ¨åŒ–çº§åˆ«+ç”¨æˆ·æ•™è‚² |
| **ç«å“å‹åŠ›** | å¸‚åœºä¸Šå¯èƒ½å‡ºç°æ›´ä¼˜ç§€çš„ç«å“ | ä¸­ | ä¸­ | æŒç»­åˆ›æ–°+å·®å¼‚åŒ–åŠŸèƒ½ |

### 10.3 ç¼“è§£æªæ–½è¯¦ç»†è®¡åˆ’

#### 1. æˆæœ¬æ§åˆ¶ç­–ç•¥
```typescript
// æ™ºèƒ½æˆæœ¬æ§åˆ¶
const COST_CONTROL = {
  // Tokené¢„ä¼°
  estimateTokens: (content: string) => content.length * 0.75,
  
  // åˆ†å±‚è°ƒç”¨ç­–ç•¥
  modelTiers: {
    draft: 'gpt-3.5-turbo',      // è‰ç¨¿é˜¶æ®µä½¿ç”¨ä¾¿å®œæ¨¡å‹
    review: 'gpt-4',             // å®¡æ ¸é˜¶æ®µä½¿ç”¨é«˜è´¨é‡æ¨¡å‹
    citation: 'claude-3-haiku',  // å¼•ç”¨æ£€æŸ¥ä½¿ç”¨ä¸“ä¸šæ¨¡å‹
  },
  
  // é™æµæœºåˆ¶
  rateLimits: {
    free: { requests: 10, tokens: 10000 },
    pro: { requests: 100, tokens: 100000 },
  }
}
```

#### 2. è´¨é‡ä¿éšœä½“ç³»
```typescript
// å¤šé‡éªŒè¯æœºåˆ¶
const QUALITY_ASSURANCE = {
  // å¼•ç”¨éªŒè¯
  citationVerification: {
    primary: 'CrossRef API',
    secondary: 'PubMed API',
    fallback: 'Manual Review Flag',
  },
  
  // å†…å®¹è´¨é‡æ£€æŸ¥
  qualityChecks: [
    'grammar_check',
    'readability_score',
    'citation_validity',
    'structure_coherence',
  ],
  
  // äººå·¥å¹²é¢„è§¦å‘æ¡ä»¶
  humanReviewTriggers: {
    lowQualityScore: 60,
    failedRetries: 3,
    userRequest: true,
  }
}
```

---

## 11. æˆåŠŸæŒ‡æ ‡

### 11.1 äº§å“KPI

| æŒ‡æ ‡ç±»åˆ« | å…·ä½“æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• | ä¼˜åŒ–ç­–ç•¥ |
|---------|----------|--------|----------|----------|
| **æ•ˆç‡æŒ‡æ ‡** | 2000å­—å®Œç¨¿æ—¶é—´ | â‰¤25min | ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ | å¾ªç¯å¼•æ“ä¼˜åŒ– |
| **è´¨é‡æŒ‡æ ‡** | å¯è¯»æ€§é€šè¿‡ç‡ | â‰¥90% | è‡ªåŠ¨æ£€æµ‹ç»Ÿè®¡ | ç®—æ³•è°ƒä¼˜ |
| **ç”¨æˆ·æ»¡æ„åº¦** | ä»»åŠ¡å®Œæˆç‡ | â‰¥85% | ç”¨æˆ·æ“ä½œç»Ÿè®¡ | UXä¼˜åŒ– |
| **ç•™å­˜æŒ‡æ ‡** | 7æ—¥ç•™å­˜ç‡ | â‰¥60% | ç”¨æˆ·è¡Œä¸ºåˆ†æ | äº§å“åŠŸèƒ½å®Œå–„ |
| **æ€§èƒ½æŒ‡æ ‡** | é¦–å±åŠ è½½æ—¶é—´ | â‰¤2s | Core Web Vitals | æŠ€æœ¯ä¼˜åŒ– |

### 11.2 æŠ€æœ¯KPI

| æŒ‡æ ‡ç±»åˆ« | å…·ä½“æŒ‡æ ‡ | ç›®æ ‡å€¼ | ç›‘æ§æ–¹æ³• | æ”¹è¿›è®¡åˆ’ |
|---------|----------|--------|----------|----------|
| **æ€§èƒ½æŒ‡æ ‡** | LCP (Largest Contentful Paint) | â‰¤2.5s | Lighthouse CI | RSCä¼˜åŒ– |
| **æ€§èƒ½æŒ‡æ ‡** | FID (First Input Delay) | â‰¤100ms | Web Vitals | äº¤äº’ä¼˜åŒ– |
| **æ€§èƒ½æŒ‡æ ‡** | CLS (Cumulative Layout Shift) | â‰¤0.1 | å¸ƒå±€ç¨³å®šæ€§ç›‘æ§ | å¸ƒå±€ä¼˜åŒ– |
| **å¯ç”¨æ€§æŒ‡æ ‡** | ç³»ç»Ÿå¯ç”¨æ€§ | â‰¥99.5% | å¥åº·æ£€æŸ¥ | å®¹é”™æœºåˆ¶ |
| **ç¼“å­˜æŒ‡æ ‡** | Rediså‘½ä¸­ç‡ | â‰¥95% | Redisç›‘æ§ | ç¼“å­˜ç­–ç•¥ä¼˜åŒ– |

### 11.3 ä¸šåŠ¡KPI

| æŒ‡æ ‡ç±»åˆ« | å…·ä½“æŒ‡æ ‡ | ç›®æ ‡å€¼ | è·Ÿè¸ªæ–¹å¼ | ä¼˜åŒ–æ–¹å‘ |
|---------|----------|--------|----------|----------|
| **æˆæœ¬æ§åˆ¶** | AI APIæˆæœ¬/åƒå­— | â‰¤$0.08 | æˆæœ¬ç»Ÿè®¡ | æ¨¡å‹ä¼˜åŒ– |
| **åŠŸèƒ½é‡‡ç”¨** | è‡ªåŠ¨æ¨¡å¼ä½¿ç”¨ç‡ | â‰¥70% | åŠŸèƒ½ç»Ÿè®¡ | ç”¨æˆ·æ•™è‚² |
| **å†…å®¹è´¨é‡** | ç”¨æˆ·æ»¡æ„åº¦è¯„åˆ† | â‰¥4.2/5 | ç”¨æˆ·è¯„ä»· | äº§å“è¿­ä»£ |
| **é”™è¯¯ç‡** | ç³»ç»Ÿé”™è¯¯ç‡ | â‰¤2% | é”™è¯¯ç›‘æ§ | ç¨³å®šæ€§æ”¹è¿› |

### 11.4 ç›‘æ§ä¸åˆ†æ

#### 1. å®æ—¶ç›‘æ§ç³»ç»Ÿ
```typescript
// ç›‘æ§é…ç½®
const MONITORING_CONFIG = {
  // æ€§èƒ½ç›‘æ§
  performance: {
    provider: 'Vercel Analytics',
    metrics: ['LCP', 'FID', 'CLS', 'TTFB'],
    alerts: {
      LCP: { threshold: 3000, channel: 'slack' },
      FID: { threshold: 150, channel: 'email' },
    }
  },
  
  // ç”¨æˆ·è¡Œä¸ºåˆ†æ
  analytics: {
    provider: 'PostHog',
    events: [
      'document_created',
      'auto_run_started',
      'workflow_completed',
      'citation_added',
    ]
  },
  
  // é”™è¯¯ç›‘æ§
  errors: {
    provider: 'Sentry',
    sampleRate: 0.1,
    ignoreErrors: ['ResizeObserver loop limit exceeded'],
  }
}
```

#### 2. å®šæœŸè¯„ä¼°æœºåˆ¶
- **æ¯å‘¨**: æŠ€æœ¯æŒ‡æ ‡reviewï¼Œæ€§èƒ½é—®é¢˜å¤„ç†
- **æ¯ä¸¤å‘¨**: ç”¨æˆ·åé¦ˆæ”¶é›†ï¼Œäº§å“è¿­ä»£è®¡åˆ’
- **æ¯æœˆ**: KPIè¾¾æˆæƒ…å†µè¯„ä¼°ï¼Œç­–ç•¥è°ƒæ•´
- **æ¯å­£åº¦**: æŠ€æœ¯å€ºåŠ¡æ¸…ç†ï¼Œæ¶æ„ä¼˜åŒ–

---

## é™„å½•

### A. æŠ€æœ¯é€‰å‹å¯¹æ¯”

| ç»´åº¦ | å½“å‰æ–¹æ¡ˆ | 2025æ–°æ–¹æ¡ˆ | é€‰æ‹©ç†ç”± |
|------|----------|------------|----------|
| **å‰ç«¯æ¡†æ¶** | Next.js 14 | Next.js 15 + React 19 | RSCç¨³å®šç‰ˆï¼Œæ›´å¥½æ€§èƒ½ |
| **çŠ¶æ€ç®¡ç†** | Context API | Zustand + TanStack Query | åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæ›´å¥½æ€§èƒ½ |
| **UIç»„ä»¶** | è‡ªå®šä¹‰ | shadcn/ui + 21st.dev | ç°ä»£åŒ–è®¾è®¡ï¼Œå¼€å‘æ•ˆç‡ |
| **æ–‡æœ¬ç¼–è¾‘** | åŸºç¡€textarea | TipTap v2 | ä¸“ä¸šå¯Œæ–‡æœ¬ç¼–è¾‘èƒ½åŠ› |
| **æ ·å¼ç³»ç»Ÿ** | CSS Modules | Tailwind CSS v4.0 | æ›´å¥½çš„å¼€å‘ä½“éªŒ |
| **PWAæ–¹æ¡ˆ** | æ—  | Workbox v8 | ç°ä»£ç¦»çº¿ä¼˜å…ˆä½“éªŒ |

### B. ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ

```typescript
// å¤–éƒ¨æœåŠ¡é…ç½®
const EXTERNAL_SERVICES = {
  // AIæœåŠ¡
  ai: {
    primary: 'Claude API',
    secondary: 'OpenAI GPT-4',
    fallback: 'MiniMax',
  },
  
  // å­¦æœ¯æ•°æ®
  academic: {
    citations: 'CrossRef API',
    papers: 'PubMed API',
    preprints: 'arXiv API',
  },
  
  // åŸºç¡€è®¾æ–½
  infrastructure: {
    hosting: 'Vercel',
    database: 'Supabase PostgreSQL',
    cache: 'Upstash Redis',
    storage: 'Vercel Blob',
  }
}
```

### C. å¼€å‘ç¯å¢ƒé…ç½®

```bash
# å¿«é€Ÿå¯åŠ¨æŒ‡ä»¤
pnpm install                    # å®‰è£…ä¾èµ–
pnpm db:setup                   # æ•°æ®åº“åˆå§‹åŒ–
pnpm dev                        # å¯åŠ¨å¼€å‘æœåŠ¡å™¨

# è´¨é‡æ£€æŸ¥
pnpm lint                       # ESLintæ£€æŸ¥
pnpm type-check                 # TypeScriptæ£€æŸ¥  
pnpm test                       # å•å…ƒæµ‹è¯•
pnpm e2e                        # ç«¯åˆ°ç«¯æµ‹è¯•

# æ„å»ºéƒ¨ç½²
pnpm build                      # ç”Ÿäº§æ„å»º
pnpm preview                    # é¢„è§ˆæ„å»ºç»“æœ
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æŠ€æœ¯æ¶æ„**: 2025Q3  
**æœ€åæ›´æ–°**: 2025-07-13  
**è´Ÿè´£äºº**: äº§å“ä¸æŠ€æœ¯å›¢é˜Ÿ  
**å®¡æ ¸çŠ¶æ€**: å·²å®Œæˆæ¶æ„å‡çº§

> æœ¬PRDæ–‡æ¡£æ•´åˆäº†å¸‚åœºåˆ†æã€ç”¨æˆ·éœ€æ±‚ã€æŠ€æœ¯é€‰å‹ã€UIè®¾è®¡ã€å®ç°è®¡åˆ’ç­‰å…¨æ–¹ä½å†…å®¹ï¼ŒåŸºäº2025å¹´7æœˆæœ€æ–°æŠ€æœ¯æ ˆï¼Œä¸ºAIå†™ä½œå·¥å…·çš„å¼€å‘æä¾›å®Œæ•´æŒ‡å¯¼ã€‚